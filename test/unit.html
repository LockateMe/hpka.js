<!DOCTYPE html>
<html>
	<head>
		<title>Test page for in-browser HPKA</title>
	</head>
	<body>
		<script src="sodium.js"></script>
		<script src="hpka.js"></script>
		<script>
			function performReqSync(reqOptions, body){
				reqOptions.body = body;

				return hpka.defaultAgent(reqOptions);
			}

			var testUsername;
			var testPassword
			var testClient;
			var serverSettings;

			var keyBuffer1, keyBuffer2;
			var key1, key2;

			/*
			Every async function will store it's result (passed through the callback) in this variable
			A method called `waitForResult` in the test client code will wait until a result is available in this variable
			*/
			var cbResult;

			function setupClient(_tu, _tp, allowGetSessions, _serverSettings){
				testUsername = _tu;
				testPassword = _tp;
				serverSettings = _serverSettings;

				keyBuffer1 = hpka.createIdentityKey(testPassword);
				keyBuffer2 = hpka.createIdentityKey(testPassword);

				key1 = hpka.loadKey(keyBuffer1, testPassword);
				key2 = hpka.loadKey(keyBuffer2, testPassword);

				testClient = new hpka.Client(testUsername, keyBuffer1, testPassword, undefined, undefined, undefined, allowGetSessions);
			}

		</script>
	</body>
</html>
